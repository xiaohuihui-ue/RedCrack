# âš™ï¸ RedCrack

<div align="center">
å°çº¢ä¹¦ å…¨ç«™ æ‰€æœ‰åŠ å¯†å‚æ•° Python çº¯ç®—é€†å‘ã€‚
    </div>


---

## ğŸ“œ é¡¹ç›®ç®€ä»‹ (Introduction)

æœ¬é¡¹ç›®æ—¨åœ¨æä¾›ä¸€ä¸ª**å­¦ä¹ å’Œç ”ç©¶ å°çº¢ä¹¦å¯¹æŠ—çˆ¬è™«å®‰å…¨é£æ§æ‰‹æ®µ çš„å¹³å°ã€‚é€šè¿‡é€†å‘å·¥ç¨‹æ–¹æ³•ï¼Œåˆ†æå¹¶é‡ç°ç½‘ç«™ç”¨äºæ•°æ®ä¿æŠ¤å’Œåçˆ¬è™«æœºåˆ¶çš„**æŠ€æœ¯åŸç†ã€‚

**æ³¨æ„ï¼š** æœ¬é¡¹ç›®ä¸­çš„ä»£ç æ˜¯åŸºäºå¯¹**å…¬å¼€å¯è®¿é—®**çš„JavaScriptä»£ç è¿›è¡Œåˆ†æå’Œ**ç‹¬ç«‹å®ç°**çš„ï¼Œä¸åŒ…å«ä»»ä½•å—ç‰ˆæƒä¿æŠ¤çš„**åŸåˆ›ä»£ç æˆ–å•†ä¸šç§˜å¯†**ã€‚

**ä¾µæƒç§»é™¤é€šçŸ¥æœºåˆ¶ï¼š** è‹¥æœ¬é¡¹ç›®çš„ä»»ä½•ä»£ç æˆ–å†…å®¹è¢«ç¬¬ä¸‰æ–¹æƒåˆ©äººè®¤ä¸ºä¾µçŠ¯äº†å…¶åˆæ³•æƒç›Šï¼ˆåŒ…æ‹¬ä½†ä¸é™äºè‘—ä½œæƒã€æ•°æ®æƒç›Šç­‰ï¼‰ï¼Œè¯·æƒåˆ©äººåŠ¡å¿…é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ä½œè€…ï¼Œæä¾›è¯¦ç»†çš„ä¾µæƒè¯æ˜ï¼š

- **è”ç³»é‚®ç®±ï¼š** fengxi9264@gmail.com

- **é€šçŸ¥è¦æ±‚ï¼š** è¯·æä¾›è¯¦ç»†çš„ä¾µæƒå†…å®¹é“¾æ¥ã€æƒåˆ©è¯æ˜æ–‡ä»¶åŠç§»é™¤è¦æ±‚ã€‚ 

ä½œè€…æ‰¿è¯ºï¼Œåœ¨æ”¶åˆ°åˆæ ¼çš„ä¾µæƒé€šçŸ¥å¹¶æ ¸å®åï¼Œå°†**ç«‹å³**å¯¹æ¶‰å«Œä¾µæƒçš„ä»£ç éƒ¨åˆ†è¿›è¡Œç§»é™¤æˆ–ä¿®æ”¹ã€‚

## ğŸš€ ä¸»è¦åŠŸèƒ½ (Features)

* é€†å‘æ‰€æœ‰å‚æ•°

  * Cookies:
    * `a1`
    * `webId`
    * `acw_tc`
    * `web_session` (æ¸¸å®¢ç”Ÿæˆ)
    * `sec_poison_id`
    * `websectiga`
    * `gid`

  * headers:
    * `x-b3-traceid`
    * `x-s`
    * `x-s-common`
    * `x-t`
    * `x-xray-traceid`

* é‡‡ç”¨ `aiohttp` å°è£…å¼‚æ­¥ `session`

* å°è£…å¤§éƒ¨åˆ†å¸¸ç”¨æ¥å£ï¼Œç®€å•ä½¿ç”¨ `xhs_session.apis.note.like_note(note_id)` å³å¯è°ƒç”¨

* é¢„ç•™ app æ“ä½œä½ç½®ï¼Œ ä¾‹å¦‚ æ‰«ç ç™»å½• / 124å®‰å…¨æ‰«ç  ç­‰ åªéœ€è¦æ ¹æ®æ³¨é‡Šæ‰çš„ä»£ç è¡¥å…¨ä½ è‡ªå·±çš„appåè®®å³å¯ã€‚

  

## âš ï¸ æ³•å¾‹åŠé£é™©å…è´£å£°æ˜ (Legal and Risk Disclaimer)

**è¯·ä»”ç»†é˜…è¯»å¹¶ç†è§£ä»¥ä¸‹æ¡æ¬¾ï¼š**

1.  **ç›®çš„é™å®šï¼š** æœ¬é¡¹ç›®ä»£ç **ä»…ä¾›ä¸ªäººå­¦ä¹ ã€æŠ€æœ¯ç ”ç©¶å’Œäº¤æµä½¿ç”¨**ã€‚
2.  **ä¸¥ç¦æ»¥ç”¨ï¼š** **ä¸¥ç¦**å°†æœ¬é¡¹ç›®ç”¨äº**ä»»ä½•å•†ä¸šç”¨é€”ã€éæ³•ç”¨é€”ã€æ¶æ„ç”¨é€”**ï¼Œæˆ–å¯¹ä»»ä½•ç¬¬ä¸‰æ–¹ç½‘ç«™è¿›è¡Œ**æ”»å‡»ã€ç ´åå…¶æ­£å¸¸æœåŠ¡æˆ–è·å–æœªç»æˆæƒçš„æ•°æ®**ã€‚
3.  **ç”¨æˆ·è´£ä»»ï¼š** ä»»ä½•ç»„ç»‡æˆ–ä¸ªäººå› ä½¿ç”¨ã€åˆ†å‘æˆ–ä»¥å…¶ä»–æ–¹å¼åˆ©ç”¨æœ¬é¡¹ç›®æ‰€é€ æˆçš„**ä¸€åˆ‡åæœ**ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºæ³•å¾‹è¯‰è®¼ã€ç»æµæŸå¤±ã€æ•°æ®æ³„éœ²ç­‰ï¼‰ï¼Œ**å‡ç”±ä½¿ç”¨è€…è‡ªè¡Œæ‰¿æ‹…**ã€‚é¡¹ç›®ä½œè€…**ä¸æ‰¿æ‹…ä»»ä½•è¿å¸¦è´£ä»»**ã€‚
4.  **æ— æ‹…ä¿ï¼š** æœ¬é¡¹ç›®**ä¸æä¾›ä»»ä½•å½¢å¼çš„æ‹…ä¿**ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº**é€‚é”€æ€§ã€ç‰¹å®šç”¨é€”é€‚ç”¨æ€§æˆ–éä¾µæƒæ€§**ã€‚
5.  **ä»£ç æ¥æºï¼š** æœ¬é¡¹ç›®ä¸­æ‰€æœ‰é€»è¾‘å’Œç®—æ³•å‡ä¸ºä½œè€…åœ¨ç†è§£å…¬å¼€æœºåˆ¶å**ç‹¬ç«‹ç¼–å†™**ï¼Œ**æœªå¤åˆ¶æˆ–åŒ…å«ä»»ä½•ç›®æ ‡ç½‘ç«™çš„åŸå§‹ã€å—ä¿æŠ¤çš„ä»£ç ç‰‡æ®µ**ã€‚

**ä¸€æ—¦æ‚¨å…‹éš†æˆ–ä¸‹è½½æœ¬é¡¹ç›®ï¼Œå³è§†ä¸ºæ‚¨å·²åŒæ„å¹¶æ¥å—ä¸Šè¿°æ‰€æœ‰æ¡æ¬¾ã€‚**




## è®¸å¯è¯ (License)

æœ¬é¡¹ç›®é‡‡ç”¨**MITè®¸å¯è¯**ã€‚




## ğŸ› ï¸ å®‰è£…ä¸ä½¿ç”¨ (Installation and Usage)

### 1. åˆ›å»º Session
```python
# å¯¼å…¥å·¥å‚æ–¹æ³•
from request.web.xhs_session import create_xhs_session

# é…ç½®ä»£ç†(å¿…é¡»)
proxy = "http://127.0.0.1:7890"

# æ–¹å¼1: æ¸¸å®¢åˆ›å»º
xhs_session = await create_xhs_session(proxy=proxy)

# æ–¹å¼2: å·²æœ‰è´¦å·ç™»å½•
xhs_session = await create_xhs_session(proxy=proxy, web_session="030037afxxxxxxxxxxxxxxxxxxxaeb59d5b4")

# æ–¹å¼3: app sid è‡ªåŠ¨æ‰«ç ç™»å½• (éœ€è‡ªè¡Œè¡¥å……appåè®®, ä½ç½®åœ¨ request/web/apis/auth.py 48è¡Œ ä¸ 101è¡Œ é™„è¿‘)
xhs_session = await create_xhs_session(proxy=proxy, sid="179999999999999999999")

```

### 2. è°ƒç”¨ Session

#### æ•´ä½“ Session åŸºäº `aiohttp` æ‰€ä»¥ä½¿ç”¨èµ·æ¥éœ€ä¿è¯åŒæ ·é£æ ¼

```python
res = await xhs_session.apis.auth.get_self_simple_info()
logger.success("ä¸ªäººä¿¡æ¯ | " + (await res.text()))

# æ‰“å°æ‰€æœ‰cookie
for a,b in xhs_session.cookies.items():
    logger.success(f'"{a}": "{b}", ')

res = await xhs_session.apis.note.note_detail("68add7d50xxxxxxxxxx37569", "ABFezCZFDcUHv-xxxxxxxxxxxHn4p5zH8=")
logger.success("ç¬”è®°è¯¦æƒ… | " + (await res.text()))

res = await xhs_session.apis.comments.get_comments("68add7d50xxxxxxxxxx37569", "ABFezCZFDcUHv-xxxxxxxxxxxHn4p5zH8=")
logger.success("ç¬”è®°è¯„è®ºåˆ—è¡¨ | " + (await res.text()))

res = await xhs_session.apis.note.search_notes("å£çº¢")
logger.success("æœç´¢ç¬”è®° | " + (await res.text()))

res = await xhs_session.apis.user.follow_user("5f86feee000000000101e3cb")
logger.success("å…³æ³¨ | " + (await res.text()))
```



### 3. å…³é—­ Session

```python
# è¦è®°å¾—å…³
await xhs_session.close_session()
```



### 4. å¢åŠ æ¥å£: 

- åœ¨ `request/web/apis` ç›®å½•ä¸‹é€‰æ‹©æ‰€éœ€æ¥å£ç±»ç›®å¯¹åº”æ·»åŠ å³å¯ï¼Œ å¢åŠ æ¨¡æ¿å¦‚ä¸‹:

  ```python
  # comments.py
  
  # postè¯·æ±‚demo
  async def demo_post(self, test_demo: str) -> aiohttp.ClientResponse:
      url = "https://edith.xiaohongshu.com/api/test_demo"
      data = {
          'test_demo': test_demo
      }
      return await self.session.request(method="post", url=url, data=data)
  
  # getè¯·æ±‚demo
  async def demo_get(self, test_demo: str) -> aiohttp.ClientResponse:
      url = "https://edith.xiaohongshu.com/api/test_demo"
      params = {
          'test_demo': test_demo
      }
      return await self.session.request(method="get", url=url, params=params)
  ```

  ç„¶åå°±å¯ä»¥ä½¿ç”¨äº†

  ```python
  res = await xhs_session.apis.comments.demo_post("test_demo")
  logger.success("demo_post | " + (await res.text()))
  
  res = await xhs_session.apis.comments.demo_get("test_demo")
  logger.success("demo_get | " + (await res.text()))
  ```

  

- å¦‚æœéœ€è¦å¢åŠ ç±»ç›®æ–‡ä»¶ï¼Œåˆ™éœ€è¦åœ¨ `__init__.py` ä¸­ æ›´æ”¹å¦‚ä¸‹ä»£ç :

  ```python
  # __init__.py
  
  class APIModule:
      def __init__(self, __session):
          self.auth = Authentication(__session)
          self.comments = Comments(__session)
          self.note = Note(__session)
          self.user = User(__session)
          
          # æ–°å¢
          self.new = New(__session)
  ```

  åŒæ—¶æ–°å»ºnew.pyæ–‡ä»¶ï¼Œå¹¶å¢åŠ å¦‚ä¸‹å†…å®¹:

  ```python
  # new.py
  import aiohttp
  
  from typing import TYPE_CHECKING
  if TYPE_CHECKING:
      from request.web.xhs_session import XHS_Session  # ä»…ç±»å‹æ£€æŸ¥æ—¶å¯¼å…¥
      
  class New:
      def __init__(self, session: "XHS_Session"):
          self.session = session  # ä¿å­˜ä¼šè¯å¼•ç”¨
          
    	# TODO STH...
  ```





### 5. å…¶ä»–

- é…ç½®æ–‡ä»¶åœ¨ `request/web/encrypt/web_encrypt_config.ini`

  - å°ç‰ˆæœ¬å·ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­å†…å«å®Œæ•´è¯´æ˜

  - åŠ å¯†é…ç½®æœ‰èƒ½åŠ›è‡ªè¡Œä¿®æ”¹



### 6. è¯·æˆ‘å–ä¸ªå’–å•¡å§

![](https://github.com/Cialle/RedCrack/blob/master/imgs/alipay.jpg?raw=true)
![](https://github.com/Cialle/RedCrack/blob/master/imgs/wechat.jpg?raw=true)


## Star History

[![Star History Chart](https://api.star-history.com/svg?repos=Cialle/RedCrack&type=date&legend=top-left)](https://www.star-history.com/#Cialle/RedCrack&type=date&legend=top-left)
